## 定义

快速幂，二进制取幂（Binary Exponentiation，也称平方法），是一个在 $O(\log n)$ 的时间内计算 $a^n$ 的小技巧，而暴力的计算需要 $O(n)$ 的时间。

这个技巧也常常用在非计算的场景，因为它可以应用在任何具有结合律的运算中。其中显然的是它可以应用于模意义下取幂、矩阵幂等运算。

## 普通版本
<!-- tabs:start -->

#### **C++**

```cpp
long long binpow(long long a, long long b) {
  long long res = 1;
  while (b > 0) {
    if (b & 1) res *= a;
    a *= a;
    b >>= 1;
  }
  return res;
}
```

#### **Java**

```java
long binpow(long a, long b) {
  long res = 1;
  while (b > 0) {
    if ((b & 1) == 1) res *= a;
    a *= a;
    b >>= 1;
  }
  return res;
}
```
<!-- tabs:end -->

## 带 mod 版本

<!-- tabs:start -->

#### **C++**

```cpp
long long binpow(long long a, long long b, long long m) {
  a %= m;
  long long res = 1;
  while (b > 0) {
    if (b & 1) res = res * a % m;
    a = a * a % m;
    b >>= 1;
  }
  return res;
}
```

#### **Java**

```java
long binpow(long a, long b, long m) {
  a %= m;
  long res = 1;
  while (b > 0) {
    if ((b & 1) == 1) res = res * a % m;
    a = a * a % m;
    b >>= 1;
  }
  return res;
}
```
<!-- tabs:end -->
